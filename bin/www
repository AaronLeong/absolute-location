#!/usr/bin/env node
var debug = require('debug')('expressapp');
var app = require('../app');
var scanner = require('../lib/scanner');

app.set('port', process.env.PORT || 3000);

var server = require('http').createServer(app);
server.listen(app.get('port'), function() {
  console.log("Express server listening on port " + app.get('port'));
});

var io = require('socket.io')(server);
io.on('connection', function (socket) {
  socket.emit('update', { hello: 'world' });
});

scanner.events.on('updateBeacons', function(beacons) {
  io.sockets.emit('updateBeacons', beacons);
});

scanner.init(500);
